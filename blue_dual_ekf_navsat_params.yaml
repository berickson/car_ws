# For parameter descriptions, please refer to the template parameter files for each node.

ekf_filter_node_odom:
  ros__parameters:
    frequency: 30.0
    two_d_mode: true # Recommended to use 2d mode for nav2 in mostly planar environments
    debug: false
    publish_tf: true
    print_diagnostics: true

    map_frame: map
    odom_frame: odom
    base_link_frame: base_footprint
    world_frame: odom    # selects main frame for the filter, map or odom

    odom0: car/odom
    odom0_config: [false, false, false, # x, y, z, 
                  false, false, false,  # roll, pitch, yaw
                  true,  true,  false,   # vx, vy, vz,
                  false, false, true,   # vroll, vpitch, vyaw
                  false, false, false]  # ax, ay, az
    odom0_queue_size: 10
    odom0_differential: false
    odom0_relative: false

    imu0: car/compass

    imu0_config: [false, false, false,   # x, y, z, 
                  false,  false,  true,  # roll, pitch, yaw
                  false, false, false,   # vx, vy, vz,
                  false,  false,  false,  # vroll, vpitch, vyaw
                  false,  false,  false]   # ax, ay, az
    imu0_differential: false
    imu0_relative: false
    imu0_queue_size: 10

    use_control: false

    process_noise_covariance: [1e-3, 0.0,    0.0,    0.0,    0.0,    0.0,    0.0,     0.0,     0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,
                              0.0,    1e-3,  0.0,    0.0,    0.0,    0.0,    0.0,     0.0,     0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,
                              0.0,    0.0,    1e-3,  0.0,    0.0,    0.0,    0.0,     0.0,     0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,
                              0.0,    0.0,    0.0,    0.3,   0.0,    0.0,     0.0,     0.0,     0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,
                              0.0,    0.0,    0.0,    0.0,    0.3,   0.0,    0.0,     0.0,     0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,
                              0.0,    0.0,    0.0,    0.0,    0.0,    0.01,  0.0,     0.0,     0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,
                              0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.5,    0.0,     0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,
                              0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,     0.5,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,
                              0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,     0.0,     0.1,   0.0,    0.0,    0.0,    0.0,    0.0,    0.0,
                              0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,     0.0,     0.0,    0.3,   0.0,    0.0,    0.0,    0.0,    0.0,
                              0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,     0.0,     0.0,    0.0,    0.3,   0.0,    0.0,    0.0,    0.0,
                              0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,     0.0,     0.0,    0.0,    0.0,    0.3,   0.0,    0.0,    0.0,
                              0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,     0.0,     0.0,    0.0,    0.0,    0.0,    0.3,   0.0,    0.0,
                              0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,     0.0,     0.0,    0.0,    0.0,    0.0,    0.0,    0.3,   0.0,
                              0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,     0.0,     0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.3]

ekf_filter_node_map:
  ros__parameters:
    frequency: 30.0
    two_d_mode: true  # Recommended to use 2d mode for nav2 in mostly planar environments
    print_diagnostics: true
    debug: false
    publish_tf: true # will publish map->odom

    map_frame: map
    odom_frame: odom
    base_link_frame: base_footprint
    world_frame: map


    odom0: car/odom
    odom0_config: [false, false, false, # x, y, z, 
                  false, false, false,  # roll, pitch, yaw
                  true,  true,  false,   # vx, vy, vz,
                  false, false, true,   # vroll, vpitch, vyaw
                  false, false, false]  # ax, ay, az
    odom0_queue_size: 10
    odom0_differential: false
    odom0_relative: false

    odom1: odometry/gps
    odom1_config: [true,  true,  false, # x, y, z
                  false, false, false,  # roll, pitch, yaw
                  false, false, false,  # vx, vy, vz
                  false, false, false,  # vroll, vpitch, vyaw
                  false, false, false]  # ax, ay, az
    odom1_queue_size: 10
    odom1_differential: false
    odom1_relative: false

    imu0: car/compass

    imu0_config: [false, false, false,   # x, y, z, 
                  false,  false,  true,  # roll, pitch, yaw
                  false, false, false,   # vx, vy, vz,
                  false,  false,  false,  # vroll, vpitch, vyaw
                  false,  false,  false]   # ax, ay, az
    imu0_differential: false
    imu0_relative: false
    imu0_queue_size: 10

    use_control: false

    ########## 
    # odom0: car/odom
    # odom0_config: [false, false, false, # x, y, z
    #               false, false, false,  # roll, pitch, yaw
    #               true,  true,  false,   # vx, vy, vz
    #               false, false, true,   # vroll, vpitch, vyaw
    #               false, false, false]  # ax, ay, az
    # odom0_queue_size: 10
    # odom0_differential: false
    # odom0_relative: false

    # odom1: odometry/gps
    # odom1_config: [true,  true,  false, # x, y, z
    #               false, false, false,  # roll, pitch, yaw
    #               false, false, false,  # vx, vy, vz
    #               false, false, false,  # vroll, vpitch, vyaw
    #               false, false, false]  # ax, ay, az
    # odom1_queue_size: 10
    # odom1_differential: false
    # odom1_relative: false

    # imu0: car/imu
    # imu0_config: [false, false, false,   # x, y, z
    #               false,  false,  true,  # roll, pitch, yaw
    #               false, false, false,   # vx, vy, vz
    #               false,  false,  false, # vroll, vpitch, vyaw
    #               false,  false,  false] # ax, ay, az
    # imu0_differential: false
    # imu0_relative: true # convert absolute yaw to angular velocity
    # imu0_queue_size: 10

    # imu1: car/compass
    # imu1_config: [false, false, false,   # x, y, z
    #               false,  false,  true,  # roll, pitch, yaw
    #               false, false, false,   # vx, vy, vz
    #               false,  false,  false, # vroll, vpitch, vyaw
    #               false,  false,  false] # ax, ay, az
    # imu1_differential: false
    # imu1_relative: false
    # imu1_queue_size: 10


    use_control: false

    process_noise_covariance: [1.0,   0.0,    0.0,    0.0,    0.0,    0.0,    0.0,     0.0,     0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,
                              0.0,    1.0,    0.0,    0.0,    0.0,    0.0,    0.0,     0.0,     0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,
                              0.0,    0.0,    1e-3,   0.0,    0.0,    0.0,    0.0,     0.0,     0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,
                              0.0,    0.0,    0.0,    0.3,    0.0,    0.0,    0.0,     0.0,     0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,
                              0.0,    0.0,    0.0,    0.0,    0.3,    0.0,    0.0,     0.0,     0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,
                              0.0,    0.0,    0.0,    0.0,    0.0,    0.01,   0.0,     0.0,     0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,
                              0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.5,     0.0,     0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,
                              0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,     0.5,     0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,
                              0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,     0.0,     0.1,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,
                              0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,     0.0,     0.0,    0.3,    0.0,    0.0,    0.0,    0.0,    0.0,
                              0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,     0.0,     0.0,    0.0,    0.3,    0.0,    0.0,    0.0,    0.0,
                              0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,     0.0,     0.0,    0.0,    0.0,    0.3,    0.0,    0.0,    0.0,
                              0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,     0.0,     0.0,    0.0,    0.0,    0.0,    0.3,    0.0,    0.0,
                              0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,     0.0,     0.0,    0.0,    0.0,    0.0,    0.0,    0.3,    0.0,
                              0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,     0.0,     0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.3]

navsat_transform:
  ros__parameters:
    frequency: 30.0
    delay: 3.0
    magnetic_declination_radians: 0.0
    yaw_offset: 0.0 #-0.43633 # -25 * M_PI / 180;
    zero_altitude: true
    broadcast_cartesian_transform: true
    publish_filtered_gps: true
    use_odometry_yaw: true
    wait_for_datum: false 
